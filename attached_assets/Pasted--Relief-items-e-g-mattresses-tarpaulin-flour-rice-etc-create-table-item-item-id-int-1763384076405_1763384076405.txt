--Relief items e.g. mattresses, tarpaulin, flour, rice, etc.
--
create table item
(
	item_id integer not null generated by default as identity
		constraint pk_item primary key,

	--Code assigned to item
	item_code varchar(16) not null
		--Item code must be uppercase and unique
		constraint c_item_1a check (item_code = upper(item_code))
		constraint uk_item_1 unique,

	item_name varchar(60) not null
		--Item name must be uppercase and unique
		constraint c_item_1b check (item_name = upper(item_name))
		constraint uk_item_2 unique,

	sku_code varchar(30) not null
		constraint c_item_1c check (sku_code = upper(sku_code))
		constraint uk_item_3 unique, --Is SKU unique/item

	--Category of item.
	category_id integer not null
		constraint fk_item_itemcatg references itemcatg,

	--Details of item properties/characteristics. Stored as case insensitive text.
	item_desc citext not null,

	--Minimum quantity at which item stock level must be increased.
	reorder_qty decimal(12,2) not null
		constraint c_item_1d check (reorder_qty > 0.00),
	
	--Type of units in which item quantity is measured by default, for instance:
	--An item varies in units of measure (UOM) e.g. meters or feet but the default UOM is feet.
	default_uom_code varchar(25) not null
		constraint fk_item_unitofmeasure references unitofmeasure,

	--An item e.g. zinc, is measured in "sheets" but may vary in size of the sheets, represented as length x width.
	--As a result, we have zinc sheets of size 16x3 feet and 10x2 feet.
	--The size of the sheet impact the average unit cost for the item.
	--The column below indicates if the size of the item should be specified in the inventory.
 
	units_size_vary_flag boolean not null default FALSE,

	--Description of any specification re: how/where item should be used/operated
	usage_desc text,

	--Description of any specification re: how/where item should be stored
	storage_desc text,

	--Is this item received/stored in batches? If true, item must be stored with a batch number.
	is_batched_flag boolean not null default TRUE,

	--Does expiration apply to use of item? If true, item must not be disbursed if expired.
	can_expire_flag boolean not null default FALSE,

	--Default order in which items are issued from inventory
	issuance_order varchar(20) not null default 'FIFO',

	--Any comments related to this item
	comments_text text,
	
	status_code char(1) not null
		--A=Active, I=Inactive
		constraint c_item_3 check (status_code in ('A','I')),

	create_by_id varchar(20) not null,
	create_dtime timestamp(0) without time zone not null,
	update_by_id varchar(20) not null,
	update_dtime timestamp(0) without time zone not null,
	version_nbr integer not null
);
--Create index on description to allow for filtering on items to be in dropdown list
create index dk_item_1 on item(item_desc);
create index dk_item_2 on item(category_id);
create index dk_item_3 on item(sku_code);