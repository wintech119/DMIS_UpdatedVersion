# DRIMS Requirements Package - README

## Package Contents

This package contains all documentation needed to rebuild the Disaster Relief Inventory Management System (DRIMS) in Replit with complete fidelity to the original system.

### ðŸ“„ Files Included

1. **DRIMS_Requirements_Document.md** (Main Document)
   - Complete functional and technical requirements
   - Role-based access control specifications
   - User interface design guidelines
   - Deployment and testing procedures
   - ~280 pages of comprehensive documentation

2. **DRIMS_Complete_Schema.sql** (Database Schema)
   - Complete PostgreSQL schema combining aidmgmt-3.sql and DRIMS extensions
   - All table definitions with constraints
   - Indexes and foreign keys
   - Seed data for initial setup
   - Ready to execute

3. **Schema_Mapping_Reference.md** (Quick Reference)
   - Table name mappings between DRIMS and aidmgmt-3.sql
   - Status code reference
   - Foreign key relationships
   - Quick lookup for developers

## ðŸŽ¯ Key Integration Points

### Schema Integration Strategy

This implementation uses a **hybrid schema** approach with **DUAL WORKFLOWS**:

1. **Core Tables from aidmgmt-3.sql** (Authoritative ODPEM Source)
   - `event` (disaster events)
   - `warehouse` (storage facilities)
   - `item` (relief items with aidmgmt-3.sql structure)
   - `donor`, `agency`, `custodian`
   - `inventory`, `location` (storage locations within warehouses)
   - `reliefrqst` â†’ `reliefpkg` â†’ `dbintake` (official ODPEM workflow)
   - `donation`, `transfer` workflows
   - All related detail tables (26 tables total)

2. **DRIMS Modern Workflow Tables** (Enhanced User Experience)
   - `needs_list` â†’ `needs_list_item` (modern needs list UI)
   - `fulfilment` â†’ `fulfilment_line_item` (enhanced fulfilment)
   - `dispatch_manifest` (detailed dispatch tracking)
   - `receipt_record` (simplified receipt)
   - `distribution_package` (alternative workflow)
   - `fulfilment_edit_log` (audit trail for changes)
   - Can coexist with aidmgmt-3.sql workflow

3. **DRIMS Support Tables** (User Management & Features)
   - `user`, `role`, `user_role` (Authentication & RBAC)
   - `user_warehouse` (Access control scoping)
   - `notification` (In-app notifications)
   - `transfer_request` (Enhanced approval workflow)
   - `transaction` (Legacy compatibility)

**Total: 51 tables** providing maximum flexibility with dual workflow support

### Critical Implementation Notes

1. **All Names Must Be UPPERCASE**
   - Warehouse names, agency names, donor names, item names
   - Enforced by CHECK constraints in database
   - Contact names must also be UPPERCASE

2. **Audit Fields Required**
   - `create_by_id`, `create_dtime`, `update_by_id`, `update_dtime`, `version_nbr`
   - Present in all aidmgmt-3.sql tables
   - Must be populated on INSERT and UPDATE

3. **Status Codes Are Single Characters**
   - Not descriptive strings (e.g., 'A' not 'Active')
   - See Schema_Mapping_Reference.md for all status codes
   - Exception: `reliefrqst.status_code` is SMALLINT (0-7)

4. **Quantity Fields Are DECIMAL(12,2)**
   - Not INTEGER
   - Supports fractional amounts
   - All quantity fields have CHECK constraints >= 0

5. **citext Extension Required**
   - For case-insensitive `item.item_desc`
   - Must be created before running schema

## ðŸš€ Quick Start Guide

### Step 1: Review Documentation
```bash
# Read in this order:
1. Schema_Mapping_Reference.md (15 min)
2. DRIMS_Complete_Schema.sql (30 min - review structure)
3. DRIMS_Requirements_Document.md (2-3 hours - comprehensive)
```

### Step 2: Set Up Database
```bash
# In PostgreSQL:
CREATE DATABASE drims_db;
\c drims_db

# Run schema:
\i DRIMS_Complete_Schema.sql
```

### Step 3: Map Your Application Code

**Old DRIMS Code â†’ New Schema:**

```python
# OLD (DRIMS):
location = Depot.query.filter_by(name='Kingston Hub').first()
event = DisasterEvent.query.filter_by(status='Active').first()
needs_list = NeedsList.query.get(id)

# NEW (Integrated Schema):
warehouse = Warehouse.query.filter_by(warehouse_name='KINGSTON HUB').first()
event = Event.query.filter_by(status_code='A').first()
reliefrqst = ReliefRqst.query.get(reliefrqst_id)
```

### Step 4: Update Model Definitions

See Section 8.1 in requirements document for Flask-SQLAlchemy model mappings.

**Key Model Changes:**
- `Depot` â†’ `Warehouse`
- `DisasterEvent` â†’ `Event`
- `NeedsList` â†’ `ReliefRqst`
- `NeedsListItem` â†’ `ReliefRqstItem`
- `Fulfilment` â†’ `ReliefPkg`
- `FulfilmentLineItem` â†’ `ReliefPkgItem`

## ðŸ“Š Data Migration Considerations

### If Migrating from Existing DRIMS Database:

1. **Table Renaming**
   ```sql
   ALTER TABLE location RENAME TO warehouse;
   ALTER TABLE disaster_event RENAME TO event;
   ALTER TABLE needs_list RENAME TO reliefrqst;
   -- etc.
   ```

2. **Column Adjustments**
   ```sql
   -- Add required audit fields if missing
   ALTER TABLE warehouse ADD COLUMN create_by_id VARCHAR(20);
   ALTER TABLE warehouse ADD COLUMN create_dtime TIMESTAMP;
   -- etc.
   ```

3. **Status Code Conversion**
   ```sql
   -- Convert status strings to codes
   UPDATE event SET status_code = 'A' WHERE status = 'Active';
   UPDATE event SET status_code = 'C' WHERE status = 'Closed';
   ```

4. **Name Uppercasing**
   ```sql
   UPDATE warehouse SET warehouse_name = UPPER(warehouse_name);
   UPDATE agency SET agency_name = UPPER(agency_name);
   UPDATE item SET item_name = UPPER(item_name);
   ```

### If Starting Fresh:

Simply run `DRIMS_Complete_Schema.sql` - it includes seed data for:
- Jamaican parishes
- Unit of measure options
- Item categories
- ODPEM custodian
- User roles

## ðŸ”’ Security Requirements

### Authentication
- Werkzeug password hashing (scrypt)
- Flask-Login session management
- Role-based access control (RBAC)

### Authorization
- 8 roles with specific permissions
- Warehouse-level access scoping
- Route-level permission decorators

### Audit Trail
- All operations logged with user attribution
- Immutable audit records
- Full transaction history

## ðŸŽ¨ UI Requirements Summary

### Branding
- **Colors:** GOJ Green (#006B3E), GOJ Gold (#FFD100)
- **Logo:** Jamaica Coat of Arms + ODPEM logo
- **Framework:** Bootstrap 5.3.3

### Key Components
- Role-specific dashboards (8 different layouts)
- Tabular data with pagination
- Status badges (color-coded)
- Real-time KPI cards
- Responsive mobile design

### Templates Required
- See requirements doc Section 6 for complete list
- ~30 Jinja2 templates
- Base template with role-based navigation

## ðŸ“± Replit Deployment

### .replit Configuration
```ini
entrypoint = "app.py"
modules = ["python-3.11", "postgresql-16"]

[nix]
channel = "stable-25_05"

[[ports]]
localPort = 5000
externalPort = 80
```

### requirements.txt
```
Flask==3.0.3
Flask-SQLAlchemy==3.1.1
Flask-Login==0.6.3
SQLAlchemy==2.0.32
Werkzeug==3.0.3
pandas==2.2.2
python-dotenv==1.0.1
psycopg2-binary==2.9.9
```

### Environment Variables
```bash
SECRET_KEY=<generate-with-secrets.token_hex(32)>
DATABASE_URL=postgresql://user:pass@host/drims_db
```

## ðŸ§ª Testing

### Test Users (See Requirements Doc Section 10.1)
```
admin@gov.jm / admin123 (System Administrator)
logistics.manager@gov.jm / logmanager123 (Logistics Manager)
logistics.officer@gov.jm / logofficer123 (Logistics Officer)
agency@gov.jm / agency123 (Agency Hub)
# ... and 4 more test accounts
```

### Test Scenarios
- Complete needs list workflow (29 steps)
- Stock management (17 steps)
- Reporting (10 steps)
- User management (8 steps)

See Section 10.2 for detailed test scenarios.

## ðŸ“ž Support & Questions

### Documentation Sections

**Getting Started:**
- Section 1: System Overview
- Section 2: Database Schema
- Section 3: Role-Based Access Control

**Development:**
- Section 4: Functional Requirements (FR-XXX-NNN codes)
- Section 5: Non-Functional Requirements
- Section 8: Technical Implementation

**Deployment:**
- Section 9: Deployment Requirements
- Section 11: Maintenance & Support

**UI/UX:**
- Section 6: User Interface Requirements
- Section 7: Visual Design Specifications

### Key Contacts

**System Owner:**  
Government of Jamaica - ODPEM

**Technical Support:**  
Refer to Section 11 of requirements document

## âœ… Implementation Checklist

- [ ] Review all three documentation files
- [ ] Set up PostgreSQL database
- [ ] Run DRIMS_Complete_Schema.sql
- [ ] Verify all tables created (51 tables total)
- [ ] Decide which workflow to use (aidmgmt-3.sql, DRIMS, or both)
- [ ] Configure Flask application
- [ ] Map all model classes to new schema
- [ ] Update all route handlers
- [ ] Update all templates with correct table/field names
- [ ] Implement role-based permission decorators
- [ ] Test authentication system
- [ ] Test complete needs list workflow
- [ ] Test all 8 role-specific dashboards
- [ ] Verify all reports generate correctly
- [ ] Load test with 50 concurrent users
- [ ] Security audit
- [ ] Deploy to Replit
- [ ] Create admin user
- [ ] Create test users
- [ ] Perform acceptance testing

## ðŸŽ¯ Success Criteria

Your implementation is complete when:

1. âœ… All 51 database tables exist and are properly indexed
2. âœ… All 8 user roles are defined and assignable
3. âœ… Authentication works with test users
4. âœ… All role-based dashboards display correctly
5. âœ… Workflow choice implemented (aidmgmt-3.sql and/or DRIMS)
6. âœ… Complete needs list/relief request workflow functions
7. âœ… Stock intake and inventory tracking works
7. âœ… Fulfilment preparation and dispatch works
8. âœ… Receipt and verification works
9. âœ… All reports generate without errors
10. âœ… Application matches original look and feel
11. âœ… GOJ branding is consistent throughout
12. âœ… Mobile responsive design works
13. âœ… All audit fields populate correctly
14. âœ… Performance meets requirements (<3s page load)
15. âœ… Security requirements met (authentication, RBAC, audit trail)

---

## ðŸ“¦ Package Version

**Version:** 2.0  
**Date:** November 11, 2025  
**Status:** Final - Ready for Implementation

**Â© 2025 Government of Jamaica. All rights reserved.**
